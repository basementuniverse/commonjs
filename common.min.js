const vec=(t,e)=>t||e?"object"==typeof t?{x:t.x||0,y:t.y||0}:null==e?{x:t,y:t}:{x:t,y:e}:{x:0,y:0};vec.components=t=>[t.x,t.y],vec.ux=()=>vec(1,0),vec.uy=()=>vec(0,1),vec.add=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),vec.mul=(t,e)=>({x:t.x*e,y:t.y*e}),vec.sub=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),vec.len=t=>Math.sqrt(t.x*t.x+t.y*t.y),vec.manhattan=t=>Math.abs(t.x)+Math.abs(t.y),vec.nor=t=>{let e=vec.len(t);return e?{x:t.x/e,y:t.y/e}:vec()},vec.dot=(t,e)=>t.x*e.x+t.y*e.y,vec.rot=(t,e)=>{let a=Math.sin(e),r=Math.cos(e);return{x:r*t.x-a*t.y,y:a*t.x+r*t.y}},vec.eq=(t,e)=>t.x===e.x&&t.y===e.y,vec.rad=t=>Math.atan2(t.y,t.x),vec.cpy=t=>vec(t),vec.map=(t,e)=>({x:e(t.x,"x"),y:e(t.y,"y")}),vec.str=(t,e=", ")=>`${t.x}${e}${t.y}`;const mat=(t=4,e=4,a=[])=>({m:t,n:e,entries:a.concat(Array(t*e).fill(0)).slice(0,t*e)});mat.identity=t=>mat(t,t,Array(t*t).fill(0).map(((e,a)=>+(Math.floor(a/t)===a%t)))),mat.get=(t,e,a)=>t.entries[a-1+(e-1)*t.n],mat.set=(t,e,a,r)=>{t.entries[a-1+(e-1)*t.n]=r},mat.row=(t,e)=>{const a=(e-1)*t.n;return t.entries.slice(a,a+t.n)},mat.col=(t,e)=>Array.times((a=>mat.get(t,a+1,e)),t.m),mat.add=(t,e)=>t.m===e.m&&t.n===e.n&&mat.map(t,((t,a)=>t+e.entries[a])),mat.sub=(t,e)=>t.m===e.m&&t.n===e.n&&mat.map(t,((t,a)=>t-e.entries[a])),mat.mul=(t,e)=>{if(t.n!==e.m)return!1;const a=mat(t.m,e.n);for(let r=1;r<=t.m;r++)for(let n=1;n<=e.n;n++)mat.set(a,r,n,Math.dot(mat.row(t,r),mat.col(e,n)));return a},mat.scale=(t,e)=>mat.map(t,(t=>t*e)),mat.trans=t=>mat(t.n,t.m,Array.times((e=>mat.col(t,e+1)),t.n).flat()),mat.minor=(t,e,a)=>{if(t.m!==t.n)return!1;const r=[];for(let n=1;n<=t.m;n++)if(n!==e)for(let e=1;e<=t.n;e++)e!==a&&r.push(mat.get(t,n,e));return mat(t.m-1,t.n-1,r)},mat.det=t=>{if(t.m!==t.n)return!1;if(1===t.m)return t.entries[0];if(2===t.m)return t.entries[0]*t.entries[3]-t.entries[1]*t.entries[2];let e=0,a=1;for(let r=1;r<=t.n;r++)e+=a*t.entries[r-1]*mat.det(mat.minor(t,1,r)),a*=-1;return e},mat.nor=t=>{if(t.m!==t.n)return!1;const e=mat.det(t);return mat.map(t,(t=>t*e))},mat.adj=t=>{const e=mat(t.m,t.n);for(let a=1;a<=t.m;a++)for(let r=1;r<=t.n;r++)mat.set(e,a,r,mat.det(mat.minor(t,a,r)));const a=mat.map(e,((t,e)=>t*(e%2?-1:1)));return mat.trans(a)},mat.inv=t=>{if(t.m!==t.n)return!1;const e=mat.det(t);return 0!==e&&mat.scale(mat.adj(t),1/e)},mat.eq=(t,e)=>t.m===e.m&&t.n===e.n&&mat.str(t)===mat.str(e),mat.cpy=t=>mat(t.m,t.n,[...t.entries]),mat.map=(t,e)=>mat(t.m,t.n,t.entries.map(e)),mat.str=(t,e=", ",a="\n")=>t.entries.chunk(t.n).map((t=>t.join(e))).join(a),Math.floatEquals=(t,e,a=Number.EPSILON)=>Math.abs(t-e)<a,Math.clamp=(t,e=0,a=1)=>t<e?e:t>a?a:t,Math.frac=t=>t>=0?t-Math.floor(t):t-Math.ceil(t),Math.lerp=(t,e,a)=>t+(e-t)*a,Math.unlerp=(t,e,a)=>(a-t)/(e-t),Math.blerp=(t,e,a,r,n,m)=>Math.lerp(Math.lerp(t,e,n),Math.lerp(a,r,n),m),Math.remap=(t,e,a,r,n)=>r+(t-e)*(n-r)/(a-e),Math.smoothstep=(t,e,a)=>Math.lerp(t,e,3*Math.pow(a,2)-2*Math.pow(a,3)),Math.radians=t=>Math.PI/180*t,Math.degrees=t=>180/Math.PI*t,Math.randomBetween=(t,e)=>Math.random()*(e-t)+t,Math.randomIntBetween=(t,e)=>Math.floor(Math.random()*(e-t+1))+t,Math.cltRandom=(t=.5,e=.5,a=2)=>{let r=0;for(let t=a;t--;)r+=Math.random();return t+(r-a/2)/(a/2)*e},Math.cltRandomInt=(t,e)=>t+Math.cltRandom(.5,.5,2)*(e-t),Math.weightedRandom=t=>{let e=t.reduce(((t,e)=>t+e),0),a=0;const r=Math.random()*e;for(;e>r;)e-=t[a++];return a-1},Math.lerpArray=(t,e,a=Math.lerp)=>{const r=e*(t.length-1),n=Math.clamp(Math.trunc(r),0,t.length-1);return a(t[n]||0,t[n+1]||0,Math.frac(r))},Math.dot=(t,e)=>t.reduce(((t,a,r)=>t+a*e[r]),0),Array.times=(t,e)=>Array(e).fill().map(((e,a)=>t(a))),Array.range=t=>Array.times((t=>t),t),Object.defineProperty(Array.prototype,"at",{value:function(t){const e=this.length;return this[t<0?e-Math.abs(t+1)%e-1:t%e]}}),Object.defineProperty(Array.prototype,"chunk",{value:function(t){return Array.times((e=>this.slice(e*t,e*t+t)),Math.ceil(this.length/t))}}),Object.defineProperty(Array.prototype,"shuffle",{value:function(){return this.map((t=>[Math.random(),t])).sort(((t,e)=>t[0]-e[0])).map((t=>t[1]))}}),"undefined"!=typeof module&&(module.exports={vec:vec,mat:mat});